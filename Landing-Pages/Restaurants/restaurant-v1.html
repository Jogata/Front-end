<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant v.1</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- <link rel="stylesheet" href="./css/style_restaurant-v1.css"> -->
    <style>
        h1 {
            text-align: center;
            text-transform: uppercase;
        }
        em {
            display: block;
            font-size: 12px;
            opacity: 0.6;
        }
        em:last-of-type {
            margin-bottom: 20px;
        }

        button {
            text-transform: uppercase;
        }
        #isbn::placeholder {
            text-transform: uppercase;
        }

        div {
            text-align: center;
            padding-bottom: 2em;
        }

        fieldset {
            margin: auto;
            padding: 1em;
            border-radius: 1em;
            width: fit-content;
            max-width: 60rem;
        }

        legend {
            margin: auto;
            padding: 0 0.4em;
            font-size: 3rem;
            text-align: center;
            text-transform: capitalize;
        }

        ol {
            margin: 0 3rem;
            /* padding: 0 1em; */
        }

        li {
            margin-bottom: 1rem;
            font-size: 3.6rem;
        }

        p {
            padding: 0.4em 1em;
            font-size: 3.6rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- <div class="landing-page">
        <nav>
            <div class="logo">
                <a href="#top">
                    <div class="logo-ring"></div>
                    <div class="logo-ring"></div>
                    <div class="logo-ring"></div>
                    <div class="logo-ring"></div>
                </a>
            </div>
            <ul role="list">
                <li><a href="#top">home</a></li>
                <li><a href="#top">about</a></li>
                <li><a href="#top">contact</a></li>
                <li><a href="#top">info</a></li>
            </ul>
            <a href="#" class="btn">add to cart</a>
        </nav>
    </div> -->
<!-- https://openlibrary.org/dev/docs/api/books -->
<h1>booktracker</h1>
<em>example: 9780140328721</em>
<em>example: 0201558025</em>
<div>
    <input type="text" name="" id="isbn" placeholder="isbn">
    <button>get a book</button>
</div>

<fieldset>
    <legend>books</legend>
    <p>Your list is empty</p>
    <ol id="books"></ol>
</fieldset>

<script>
    class MyLocalStorage {
        constructor() {
            this.storage = [];
        }

        setItem(item) {
            this.storage.push(item);
        }
        getItem(i) {
            console.log(this);
            return this.storage[i];
        }
        getAllItems() {
            return this.storage;
        }
        deleteItem(item) {
            this.storage.pop(item);
        }
    }

    const myLocalStorage = new MyLocalStorage();

    // myLocalStorage.storage[0] = "9780140328721";
    // myLocalStorage.storage[1] = "0201558025";

    console.log(myLocalStorage.getAllItems());

    if (myLocalStorage.storage[0]) {
        const parentEl = document.querySelector("fieldset");
        parentEl.removeChild(document.querySelector("p"));
        myLocalStorage.storage.forEach((isbn, index) => {
        // console.log(myLocalStorage.getItem(index));
        const url = `https://openlibrary.org/isbn/${myLocalStorage.getItem(index)}.json`;
        fetch(url)
        .then(data => data.json())
        .then(data => {
            console.log(data);
            const title = data.title;
            console.log(title);
            // myLocalStorage.setItem(isbn);
            // console.log(myLocalStorage);
            const liEl = document.createElement("li");
            liEl.textContent = title;
            const parentEl = document.querySelector("#books");
            parentEl.appendChild(liEl);
        })
        .catch(err => {
            console.log(err);
        });
    })
    } else {
        
    }

    
    const btn = document.querySelector("button");
    
    btn.addEventListener("click", () => {
        const isbn = document.querySelector("#isbn").value;
        const url = `https://openlibrary.org/isbn/${isbn}.json`;
        fetch(url)
        .then(data => data.json())
        .then(data => {
            console.log(data);
            const title = data.title;
            console.log(title);
            myLocalStorage.setItem(isbn);
            console.log(myLocalStorage);
            const liEl = document.createElement("li");
            liEl.textContent = title;
            const parentEl = document.querySelector("#books");
            // parentEl.removeChild(document.querySelector("p"));
            parentEl.appendChild(liEl);
        })
        .catch(err => {
            console.log(err);
        });
    })
</script>
</body>
</html>