<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forest</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/styles-forest.css">
</head>
<body>
    <header id="top">
        <div class="landing-page">
            <div class="header-bar">
                <div class="logo">
                    <span class="accent">be</span>Wild
                    <img src="./img/Forest/decoration/mint.png" alt="Mint leaves" class="mint">
                </div>
                <div class="nav-container">
                    <div class="inner-container">
                        <nav>
                            <div class="nav-link-container">
                                <a class="nav-link" href="#top">home</a>
                                <img src="./img/Forest/decoration/hibiscus.png" alt="Flower" class="flower-left">
                                <img src="./img/Forest/decoration/hummingbird.png" alt="Hummingbird" class="hummingbird-left">
                            </div>
                            <div class="nav-link-container">
                                <a class="nav-link" href="#top">gallery</a>
                            </div>
                            <div class="nav-link-container">
                                <a class="nav-link" href="#top">contact</a>
                                <img src="./img/Forest/decoration/single-flower.png" alt="Flower" class="flower-right">
                                <img src="./img/Forest/decoration/hummingbird-green.png" alt="Hummingbird" class="hummingbird-right">
                            </div>
                            <div class="nav-link-container">
                                <a class="nav-link" href="#top">about&nbsp;us</a>
                            </div>
                        </nav>
                        <img src="./img/TheWildLife/decoration/green-vine-leaves.png" alt="Vines" class="vines">
                    </div>
                </div>
                <button class="sound">sound
                    <i class="fa fa-music" aria-hidden="true"></i>
                </button>
                <button id="hamburger-menu" class="hamburger-menu-button">
                    <span class="menu-icon">menu</span>
                </button>
            </div>
            <div class="intro">
                <div class="fade-out">
                    <div id="prevent-event-bubbling" class="intro-inside-grid">
                        <img src="./img/Forest/the-wild-spring.png" alt="Elk" class="hero">
                        <h1>
                            <span class="left" style="--i:1">save</span>
                            <span class="right" style="--i:2">the</span>
                            <span class="block" style="--i:3">nature</span>
                        </h1>
                    </div>
                </div>
                <!-- <img src="./img/Forest/elk.png" alt="Elk" class="hero"> -->
                <!-- the forest is their home -->
                <!-- <h2>
                    <span class="top-left">the</span>
                    <span class="top-right">forest</span>
                    <span class="second-row">is</span>
                    <span class="third-row">their</span>
                    <span class="forth-row">home</span>
                </h2> -->
                <!-- <img src="./img/Forest/brown-bear.png" alt="Brown bear" class="hero bear"> -->
                <!-- explore the animal world with us! -->
                <!-- <h2 class="bear-text">
                    <span class="top-left">explore</span>
                    <span class="second-row" style="grid-column: 1 / 2; grid-row: 2 / 3;">the</span>
                    <span class="middle" style="grid-column: 1 / 2; grid-row: 3 / 4; text-align: end;">animal</span>
                    <span class="forth-row-left">world</span>
                    <span class="fifth-row">with us!</span>
                </h2> -->
            </div>
            <div class="nat-geo-logo">
                <img src="./img/Forest/decoration/hazelnut.png" alt="Hazelnut" class="hazelnut">
                <img src="./img/Forest/decoration/squirrel.png" alt="Squirrel" class="squirrel">
                <img src="./img/Forest/decoration/national-geographic-logo.png" alt="National Geographic Logo">
                <img src="./img/Forest/decoration/earth.png" alt="Planet Earth" class="earth">
            </div>
        </div>
    </header>
    <audio id="track" loop autoplay muted>
        <source src="./media/forest-sounds.mp3" type="audio/mp3">
    </audio>

    <template class="slide1">
        <div class="fade-out">
            <div id="prevent-event-bubbling" class="intro-inside-grid">
                <img src="./img/Forest/the-wild-spring.png" alt="Elk" class="hero">
                <h1>
                    <span class="left" style="--i:1">save</span>
                    <span class="right" style="--i:2">the</span>
                    <span class="block" style="--i:3">nature</span>
                </h1>
            </div>
        </div>
    </template>
    <template class="slide2">
        <div class="fade-out">
            <div id="prevent-event-bubbling" class="intro-inside-grid">
                <img src="./img/Forest/elk.png" alt="Elk" class="hero">
                <!-- the forest is their home -->
                <h2>
                    <span class="top-left" style="--i:1">the</span>
                    <span class="top-right" style="--i:2">forest</span>
                    <span class="second-row-left" style="--i:3">is</span>
                    <span class="third-row-center" style="--i:4">their</span>
                    <span class="forth-row" style="--i:5">home</span>
                </h2>
            </div>
        </div>
    </template>
    <template class="slide3">
        <div>
            <div id="prevent-event-bubbling" class="intro-inside-grid">
                <img src="./img/Forest/brown-bear.png" alt="Brown bear" class="hero bear">
                <!-- explore the animal world with us! -->
                <h2 class="bear-text">
                    <span class="top-left" style="--i:1">explore</span>
                    <span class="second-row" style="--i:2">the</span>
                    <span class="third-row" style="--i:3">animal</span>
                    <span class="forth-row-left" style="--i:4">world</span>
                    <span class="fifth-row" style="--i:5">with us!</span>
                </h2>
            </div>
        </div>
    </template>
    <template class="explore-button">
        <a href="#top" class="explore" style="--i:6">continue</a>
    </template>
</body>

<script>
    addEvents();
    setupNavigation();
    setupSlider();

    function addEvents() {
        addSoundButtonEvent();
        addHamburgerMenuEvent()
    }
    
    function addSoundButtonEvent() {
        const soundButton = document.querySelector('.sound');
        soundButton.addEventListener('click', () => {
            const audioTrack = document.getElementById('track');
            audioTrack.muted = !audioTrack.muted;
            soundButton.classList.toggle('on');
        })
    }

    function addHamburgerMenuEvent() {
        const hamburgerButton = document.querySelector('#hamburger-menu');
        hamburgerButton.addEventListener('click', () => {
            hamburgerButton.classList.toggle('active');
            const menuIcon = document.querySelector('.menu-icon');
            menuIcon.classList.toggle('opened');
            const navigation = document.querySelector('.nav-container');
            navigation.classList.toggle('full-screen');
        })
    }

    function setupSlider() {
        const slider = document.querySelector('.intro');
        let index = 0;
        preventEventBubbling();
        // slider.addEventListener('animationend', nextSlide);
        slider.addEventListener('animationend', () => {
            // console.log(event.elapsedTime)
            slider.innerHTML = '';
            const templates = document.getElementsByTagName("template");
            index++;
            if (index > templates.length - 2) {
                slider.removeEventListener('animationend');
            }
            const slide = templates[index];
            const clon = slide.content.cloneNode(true);
            slider.appendChild(clon);
            preventEventBubbling();
            if (index === (templates.length - 2)) {
                const button = templates[templates.length - 1];
                const clon = button.content.cloneNode(true);
                const parent = document.querySelector('.landing-page');
                parent.appendChild(clon);
            }
    })
    }

    // var nextSlide = (slider) => {
    //         slider.innerHTML = '';
    //         const templates = document.getElementsByTagName("template");
    //         index++;
    //         if (index > templates.length - 2) {
    //             slider.removeEventListener('animationend', nextSlide);
    //         }
    //         const slide = templates[index];
    //         const clon = slide.content.cloneNode(true);
    //         slider.appendChild(clon);
    //         preventEventBubbling();
    //         if (index === (templates.length - 2)) {
    //             const button = templates[templates.length - 1];
    //             const clon = button.content.cloneNode(true);
    //             const parent = document.querySelector('.landing-page');
    //             parent.appendChild(clon);
    //         }
    // }

    function preventEventBubbling() {
        const containerPreventingBubbling = document.querySelector('#prevent-event-bubbling');
        containerPreventingBubbling.addEventListener('animationend', e => {
            e.stopPropagation();
        })
    }
// ===================================================================================      change slides onclick
    const slider = document.querySelector('.intro');
    let index = 0;
    slider.addEventListener('click', () => {
        slider.innerHTML = '';
        const templates = document.getElementsByTagName("template");
        index++;
        if (index > templates.length - 2) {
            index = 0;
            const button = document.querySelector('.explore');
            button.remove();
        }
        const temp = templates[index];
        const clon = temp.content.cloneNode(true);
        slider.appendChild(clon);
        if (index === (templates.length - 2)) {
            const button = templates[templates.length - 1];
            const clon = button.content.cloneNode(true);
            const parent = document.querySelector('.landing-page');
            parent.appendChild(clon);
        }
    })
// ===================================================================================

    function setupNavigation() {
        const links = document.querySelectorAll('.nav-link-container');
        links.forEach(link => {
            let text = link.children[0].innerText.split('');
            link.children[0].innerHTML = '';
            text.forEach((letter, index) => {
                link.children[0].innerHTML += `<span style="--i: ${index}">${letter}</span>`;
            })
            let clone = link.children[0].cloneNode(true);
            link.appendChild(clone);
        })
    }
</script>
</html>